---
title: 递归的缺点--以斐波那契数列为例
date: 2017-07-11 23:36:01
tags: 算法
---

递归可以大大简化代码,但可能会出现大量重复计算,拖累程序的效率. 以斐波那契数列为例,探寻 *递归/非递归算法*两者的时间和空间差距


<br>

### 递归写法

<br>

```go
package main

import (
	"fmt"
	"time"
)

const N = 40

func main() {
	start := time.Now()
	var sli []int64
	for i := 1; i <= N; i++ {
		sli = append(sli, fibonacci(i))
	}

	fmt.Printf("%d位的斐波那契数列为:%v\n", N, sli)
	fmt.Println("用时:", time.Since(start))
}

func fibonacci(n int) (res int64) {
	if n <= 2 {
		res = 1
	} else {
		res = fibonacci(n-1) + fibonacci(n-2)
	}
	return
}
```

<br>

当N=40时,输出为:


```java
40位的斐波那契数列为:[1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155]
用时: 968.053722ms

```

当N改为50时,耗时将陡然增多至2分钟.

```java
50位的斐波那契数列为:[1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025]
50
用时: 1m59.794771009s

```

<br>


---


<br>


### 非递归写法

<br>

```go
package main

import (
	"fmt"
	"time"
)

const N2 = 40

func main() {
	start := time.Now()
	var sli []int64
	for i := 1; i <= N2; i++ {
		sli = append(sli, fibonacci2(i))
	}

	fmt.Printf("%d位的斐波那契数列为:%v\n", N2, sli)

	fmt.Println("用时:", time.Since(start))
}

func fibonacci2(n int) (res int64) {

	var a, b int64 = 0, 1
	
	for i := 0; i < n; i++ {
		a, b = b, a+b
	}
	return a
}

```

N2=40时,输出为:

```java
40位的斐波那契数列为:[1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155]
用时: 79.884µs
```

<br>

当N改为50时,结果为:

```java
50位的斐波那契数列为:[1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025]
用时: 89.938µs
```


---

<br>


可见,差距相当相当明显!

当然,对于斐波那契数列,其非递归写法也非常简单,但对于更多情况下,非递归实现要比递归写法复杂很多.



